running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_iwae --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 10 --filter
sha: af5404ef6e6fbc428d48a9dc4c9a0ea91b813775
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=10, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_iwae', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
(15854.4453125, 14670.08740234375, -14670.087829589844)
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  2.41s | valid ELBO 15635.30 | valid NLL 14667.26 | PPL: 15635.30 | true PPL: 14667.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  1.94s | valid ELBO 15497.73 | valid NLL 14670.26 | PPL: 15497.73 | true PPL: 14670.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  1.72s | valid ELBO 15376.36 | valid NLL 14667.37 | PPL: 15376.36 | true PPL: 14667.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  1.71s | valid ELBO 15271.71 | valid NLL 14665.78 | PPL: 15271.71 | true PPL: 14665.76
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  1.70s | valid ELBO 15182.03 | valid NLL 14664.51 | PPL: 15182.03 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  1.71s | valid ELBO 15122.29 | valid NLL 14667.66 | PPL: 15122.29 | true PPL: 14667.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  1.71s | valid ELBO 15060.06 | valid NLL 14663.75 | PPL: 15060.06 | true PPL: 14663.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  1.70s | valid ELBO 15009.86 | valid NLL 14663.25 | PPL: 15009.86 | true PPL: 14663.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  1.71s | valid ELBO 14970.52 | valid NLL 14665.36 | PPL: 14970.52 | true PPL: 14665.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  1.70s | valid ELBO 14936.50 | valid NLL 14666.14 | PPL: 14936.50 | true PPL: 14666.11
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  1.70s | valid ELBO 14908.17 | valid NLL 14663.54 | PPL: 14908.17 | true PPL: 14663.52
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  1.69s | valid ELBO 14886.79 | valid NLL 14663.45 | PPL: 14886.79 | true PPL: 14663.42
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  1.71s | valid ELBO 14867.64 | valid NLL 14665.04 | PPL: 14867.64 | true PPL: 14665.00
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  1.70s | valid ELBO 14845.74 | valid NLL 14663.56 | PPL: 14845.74 | true PPL: 14663.50
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  1.70s | valid ELBO 14831.03 | valid NLL 14665.25 | PPL: 14831.03 | true PPL: 14665.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  1.70s | valid ELBO 14819.85 | valid NLL 14669.06 | PPL: 14819.85 | true PPL: 14668.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  1.70s | valid ELBO 14800.68 | valid NLL 14664.00 | PPL: 14800.68 | true PPL: 14663.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  1.71s | valid ELBO 14788.59 | valid NLL 14664.75 | PPL: 14788.59 | true PPL: 14664.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  1.70s | valid ELBO 14777.55 | valid NLL 14666.69 | PPL: 14777.55 | true PPL: 14666.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  1.72s | valid ELBO 14765.86 | valid NLL 14664.41 | PPL: 14765.86 | true PPL: 14664.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  1.71s | valid ELBO 14758.93 | valid NLL 14664.54 | PPL: 14758.93 | true PPL: 14664.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  2.17s | valid ELBO 14751.62 | valid NLL 14665.03 | PPL: 14751.62 | true PPL: 14664.96
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  1.72s | valid ELBO 14746.63 | valid NLL 14667.01 | PPL: 14746.63 | true PPL: 14666.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  1.70s | valid ELBO 14740.80 | valid NLL 14667.44 | PPL: 14740.80 | true PPL: 14667.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  1.69s | valid ELBO 14732.98 | valid NLL 14665.62 | PPL: 14732.98 | true PPL: 14665.53
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  1.70s | valid ELBO 14728.02 | valid NLL 14665.49 | PPL: 14728.02 | true PPL: 14665.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  1.72s | valid ELBO 14722.15 | valid NLL 14663.75 | PPL: 14722.15 | true PPL: 14663.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  1.72s | valid ELBO 14717.20 | valid NLL 14663.89 | PPL: 14717.20 | true PPL: 14663.80
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  1.72s | valid ELBO 14713.90 | valid NLL 14665.29 | PPL: 14713.90 | true PPL: 14665.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  1.71s | valid ELBO 14708.75 | valid NLL 14663.43 | PPL: 14708.75 | true PPL: 14663.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  1.72s | valid ELBO 14705.63 | valid NLL 14663.52 | PPL: 14705.63 | true PPL: 14663.45
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  1.71s | valid ELBO 14705.17 | valid NLL 14665.04 | PPL: 14705.17 | true PPL: 14664.96
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  1.72s | valid ELBO 14703.80 | valid NLL 14666.32 | PPL: 14703.80 | true PPL: 14666.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  1.72s | valid ELBO 14698.41 | valid NLL 14664.45 | PPL: 14698.41 | true PPL: 14664.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  1.71s | valid ELBO 14697.67 | valid NLL 14664.70 | PPL: 14697.67 | true PPL: 14664.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  1.71s | valid ELBO 14695.49 | valid NLL 14665.19 | PPL: 14695.49 | true PPL: 14665.12
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  1.71s | valid ELBO 14693.96 | valid NLL 14665.28 | PPL: 14693.96 | true PPL: 14665.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  1.71s | valid ELBO 14691.24 | valid NLL 14664.47 | PPL: 14691.24 | true PPL: 14664.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  1.71s | valid ELBO 14689.83 | valid NLL 14664.77 | PPL: 14689.83 | true PPL: 14664.69
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  1.72s | valid ELBO 14688.20 | valid NLL 14664.23 | PPL: 14688.20 | true PPL: 14664.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  1.70s | valid ELBO 14687.71 | valid NLL 14665.56 | PPL: 14687.71 | true PPL: 14665.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  1.70s | valid ELBO 14688.63 | valid NLL 14666.81 | PPL: 14688.63 | true PPL: 14666.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  1.69s | valid ELBO 14685.58 | valid NLL 14665.47 | PPL: 14685.58 | true PPL: 14665.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  1.70s | valid ELBO 14684.68 | valid NLL 14665.25 | PPL: 14684.68 | true PPL: 14665.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  1.70s | valid ELBO 14683.40 | valid NLL 14664.25 | PPL: 14683.40 | true PPL: 14664.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  1.71s | valid ELBO 14682.94 | valid NLL 14665.45 | PPL: 14682.94 | true PPL: 14665.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  1.72s | valid ELBO 14682.69 | valid NLL 14666.28 | PPL: 14682.69 | true PPL: 14666.19
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  1.72s | valid ELBO 14680.19 | valid NLL 14664.15 | PPL: 14680.19 | true PPL: 14664.05
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  1.72s | valid ELBO 14679.53 | valid NLL 14664.50 | PPL: 14679.53 | true PPL: 14664.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  1.71s | valid ELBO 14678.54 | valid NLL 14664.21 | PPL: 14678.54 | true PPL: 14664.11
--------------------------------------------------------------------------------
