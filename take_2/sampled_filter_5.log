running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_filter --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 5 --filter
sha: af5404ef6e6fbc428d48a9dc4c9a0ea91b813775
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=5, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_filter', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
(14674.935546875, 73350.43579101562, -14670.087829589844)
-----------------------------------------------------------------------------------------
ELBO: 14674.94, val_nll: 73350.44, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  1.16s | valid ELBO 14675.54 | valid NLL 73348.86 | PPL: 14675.54 | true PPL: 14669.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  0.98s | valid ELBO 14670.03 | valid NLL 73336.29 | PPL: 14670.03 | true PPL: 14667.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  0.95s | valid ELBO 14666.17 | valid NLL 73327.77 | PPL: 14666.17 | true PPL: 14665.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  0.95s | valid ELBO 14669.11 | valid NLL 73348.59 | PPL: 14669.11 | true PPL: 14668.32
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  0.97s | valid ELBO 14666.17 | valid NLL 73332.39 | PPL: 14666.17 | true PPL: 14665.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  0.95s | valid ELBO 14662.44 | valid NLL 73327.65 | PPL: 14662.44 | true PPL: 14664.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  0.95s | valid ELBO 14665.55 | valid NLL 73332.92 | PPL: 14665.55 | true PPL: 14664.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  0.97s | valid ELBO 14664.50 | valid NLL 73320.62 | PPL: 14664.50 | true PPL: 14663.11
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  0.96s | valid ELBO 14663.23 | valid NLL 73321.83 | PPL: 14663.23 | true PPL: 14663.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  0.95s | valid ELBO 14664.34 | valid NLL 73326.34 | PPL: 14664.34 | true PPL: 14664.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  0.96s | valid ELBO 14665.91 | valid NLL 73326.44 | PPL: 14665.91 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  0.97s | valid ELBO 14663.28 | valid NLL 73328.57 | PPL: 14663.28 | true PPL: 14663.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  0.97s | valid ELBO 14664.12 | valid NLL 73327.09 | PPL: 14664.12 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  0.97s | valid ELBO 14665.55 | valid NLL 73332.14 | PPL: 14665.55 | true PPL: 14664.81
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  0.97s | valid ELBO 14669.49 | valid NLL 73339.36 | PPL: 14669.49 | true PPL: 14665.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  0.96s | valid ELBO 14669.79 | valid NLL 73346.62 | PPL: 14669.79 | true PPL: 14666.78
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  0.97s | valid ELBO 14666.72 | valid NLL 73334.23 | PPL: 14666.72 | true PPL: 14665.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  0.99s | valid ELBO 14665.65 | valid NLL 73327.50 | PPL: 14665.65 | true PPL: 14664.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  0.98s | valid ELBO 14665.75 | valid NLL 73333.61 | PPL: 14665.75 | true PPL: 14665.07
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  0.98s | valid ELBO 14667.61 | valid NLL 73336.89 | PPL: 14667.61 | true PPL: 14665.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  0.98s | valid ELBO 14667.43 | valid NLL 73334.06 | PPL: 14667.43 | true PPL: 14665.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  0.98s | valid ELBO 14665.77 | valid NLL 73330.37 | PPL: 14665.77 | true PPL: 14664.94
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  0.98s | valid ELBO 14666.12 | valid NLL 73336.63 | PPL: 14666.12 | true PPL: 14665.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  1.00s | valid ELBO 14667.02 | valid NLL 73335.72 | PPL: 14667.02 | true PPL: 14665.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  0.95s | valid ELBO 14666.94 | valid NLL 73338.63 | PPL: 14666.94 | true PPL: 14665.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  0.95s | valid ELBO 14667.48 | valid NLL 73334.85 | PPL: 14667.48 | true PPL: 14665.55
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  0.94s | valid ELBO 14665.79 | valid NLL 73328.55 | PPL: 14665.79 | true PPL: 14664.23
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  0.94s | valid ELBO 14665.21 | valid NLL 73332.69 | PPL: 14665.21 | true PPL: 14664.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  0.95s | valid ELBO 14664.78 | valid NLL 73326.59 | PPL: 14664.78 | true PPL: 14664.58
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  0.96s | valid ELBO 14664.28 | valid NLL 73327.94 | PPL: 14664.28 | true PPL: 14664.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  0.96s | valid ELBO 14665.65 | valid NLL 73328.07 | PPL: 14665.65 | true PPL: 14663.97
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  0.94s | valid ELBO 14665.82 | valid NLL 73325.67 | PPL: 14665.82 | true PPL: 14664.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  0.95s | valid ELBO 14663.55 | valid NLL 73326.99 | PPL: 14663.55 | true PPL: 14665.11
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  0.96s | valid ELBO 14664.45 | valid NLL 73327.84 | PPL: 14664.45 | true PPL: 14664.78
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  0.95s | valid ELBO 14667.11 | valid NLL 73331.92 | PPL: 14667.11 | true PPL: 14664.89
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  0.96s | valid ELBO 14664.71 | valid NLL 73327.68 | PPL: 14664.71 | true PPL: 14664.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  0.96s | valid ELBO 14665.39 | valid NLL 73329.78 | PPL: 14665.39 | true PPL: 14664.75
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  0.96s | valid ELBO 14665.96 | valid NLL 73326.99 | PPL: 14665.96 | true PPL: 14664.42
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  0.96s | valid ELBO 14665.69 | valid NLL 73331.11 | PPL: 14665.69 | true PPL: 14664.64
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  0.95s | valid ELBO 14666.10 | valid NLL 73328.32 | PPL: 14666.10 | true PPL: 14664.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  0.94s | valid ELBO 14666.33 | valid NLL 73331.18 | PPL: 14666.33 | true PPL: 14665.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  0.94s | valid ELBO 14667.90 | valid NLL 73337.20 | PPL: 14667.90 | true PPL: 14665.52
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  0.94s | valid ELBO 14665.59 | valid NLL 73329.08 | PPL: 14665.59 | true PPL: 14665.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  0.95s | valid ELBO 14665.50 | valid NLL 73328.31 | PPL: 14665.50 | true PPL: 14665.14
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  0.94s | valid ELBO 14664.24 | valid NLL 73327.45 | PPL: 14664.24 | true PPL: 14664.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  0.95s | valid ELBO 14665.63 | valid NLL 73327.66 | PPL: 14665.63 | true PPL: 14665.28
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  0.96s | valid ELBO 14664.68 | valid NLL 73330.48 | PPL: 14664.68 | true PPL: 14665.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  0.95s | valid ELBO 14664.04 | valid NLL 73322.79 | PPL: 14664.04 | true PPL: 14664.50
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  0.96s | valid ELBO 14665.40 | valid NLL 73323.30 | PPL: 14665.40 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  0.96s | valid ELBO 14664.78 | valid NLL 73320.76 | PPL: 14664.78 | true PPL: 14664.56
--------------------------------------------------------------------------------
