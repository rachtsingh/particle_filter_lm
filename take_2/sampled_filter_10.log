running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_filter --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 10 --filter
sha: af5404ef6e6fbc428d48a9dc4c9a0ea91b813775
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=10, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_filter', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
(14670.396484375, 146700.8837890625, -14670.087829589844)
-----------------------------------------------------------------------------------------
ELBO: 14670.40, val_nll: 146700.88, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  1.34s | valid ELBO 14674.34 | valid NLL 146692.56 | PPL: 14674.34 | true PPL: 14669.10
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  1.20s | valid ELBO 14666.73 | valid NLL 146671.55 | PPL: 14666.73 | true PPL: 14666.03
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  1.20s | valid ELBO 14666.28 | valid NLL 146676.77 | PPL: 14666.28 | true PPL: 14667.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  1.19s | valid ELBO 14668.24 | valid NLL 146688.63 | PPL: 14668.24 | true PPL: 14668.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  1.19s | valid ELBO 14666.35 | valid NLL 146667.06 | PPL: 14666.35 | true PPL: 14665.23
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  1.20s | valid ELBO 14664.52 | valid NLL 146663.46 | PPL: 14664.52 | true PPL: 14665.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  1.20s | valid ELBO 14664.30 | valid NLL 146647.98 | PPL: 14664.30 | true PPL: 14664.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  1.25s | valid ELBO 14664.67 | valid NLL 146646.93 | PPL: 14664.67 | true PPL: 14663.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  1.19s | valid ELBO 14663.39 | valid NLL 146649.96 | PPL: 14663.39 | true PPL: 14663.53
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  1.19s | valid ELBO 14664.13 | valid NLL 146666.74 | PPL: 14664.13 | true PPL: 14664.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  1.20s | valid ELBO 14665.10 | valid NLL 146654.75 | PPL: 14665.10 | true PPL: 14663.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  1.20s | valid ELBO 14664.06 | valid NLL 146648.28 | PPL: 14664.06 | true PPL: 14663.27
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  1.20s | valid ELBO 14664.54 | valid NLL 146649.01 | PPL: 14664.54 | true PPL: 14663.76
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  1.20s | valid ELBO 14664.99 | valid NLL 146661.45 | PPL: 14664.99 | true PPL: 14664.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  1.21s | valid ELBO 14665.45 | valid NLL 146664.24 | PPL: 14665.45 | true PPL: 14665.38
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  1.21s | valid ELBO 14668.00 | valid NLL 146684.29 | PPL: 14668.00 | true PPL: 14667.30
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  1.21s | valid ELBO 14664.84 | valid NLL 146658.00 | PPL: 14664.84 | true PPL: 14665.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  1.20s | valid ELBO 14664.16 | valid NLL 146652.69 | PPL: 14664.16 | true PPL: 14664.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  1.20s | valid ELBO 14664.00 | valid NLL 146657.66 | PPL: 14664.00 | true PPL: 14664.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  1.20s | valid ELBO 14666.30 | valid NLL 146670.72 | PPL: 14666.30 | true PPL: 14665.25
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  1.20s | valid ELBO 14667.11 | valid NLL 146668.57 | PPL: 14667.11 | true PPL: 14665.04
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  1.20s | valid ELBO 14664.76 | valid NLL 146658.30 | PPL: 14664.76 | true PPL: 14664.50
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  1.20s | valid ELBO 14665.72 | valid NLL 146666.18 | PPL: 14665.72 | true PPL: 14665.10
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  1.19s | valid ELBO 14665.53 | valid NLL 146667.84 | PPL: 14665.53 | true PPL: 14665.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  1.20s | valid ELBO 14666.29 | valid NLL 146672.27 | PPL: 14666.29 | true PPL: 14665.75
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  1.19s | valid ELBO 14664.80 | valid NLL 146661.67 | PPL: 14664.80 | true PPL: 14665.38
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  1.20s | valid ELBO 14665.81 | valid NLL 146644.64 | PPL: 14665.81 | true PPL: 14663.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  1.20s | valid ELBO 14664.88 | valid NLL 146648.01 | PPL: 14664.88 | true PPL: 14664.06
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  1.19s | valid ELBO 14664.38 | valid NLL 146648.82 | PPL: 14664.38 | true PPL: 14664.55
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  1.19s | valid ELBO 14664.81 | valid NLL 146657.20 | PPL: 14664.81 | true PPL: 14664.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  1.19s | valid ELBO 14665.14 | valid NLL 146646.54 | PPL: 14665.14 | true PPL: 14664.06
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  1.19s | valid ELBO 14664.56 | valid NLL 146649.10 | PPL: 14664.56 | true PPL: 14664.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  1.21s | valid ELBO 14666.06 | valid NLL 146661.11 | PPL: 14666.06 | true PPL: 14665.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  1.20s | valid ELBO 14663.69 | valid NLL 146655.28 | PPL: 14663.69 | true PPL: 14664.97
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  1.20s | valid ELBO 14665.75 | valid NLL 146654.76 | PPL: 14665.75 | true PPL: 14665.06
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  1.20s | valid ELBO 14666.41 | valid NLL 146664.33 | PPL: 14666.41 | true PPL: 14665.00
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  1.20s | valid ELBO 14664.62 | valid NLL 146652.31 | PPL: 14664.62 | true PPL: 14664.83
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  1.20s | valid ELBO 14665.51 | valid NLL 146657.43 | PPL: 14665.51 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  1.20s | valid ELBO 14664.70 | valid NLL 146647.11 | PPL: 14664.70 | true PPL: 14664.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  1.23s | valid ELBO 14664.01 | valid NLL 146656.11 | PPL: 14664.01 | true PPL: 14664.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  1.20s | valid ELBO 14665.07 | valid NLL 146661.39 | PPL: 14665.07 | true PPL: 14665.24
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  1.19s | valid ELBO 14666.37 | valid NLL 146668.95 | PPL: 14666.37 | true PPL: 14665.76
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  1.18s | valid ELBO 14666.13 | valid NLL 146662.73 | PPL: 14666.13 | true PPL: 14665.54
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  1.21s | valid ELBO 14665.30 | valid NLL 146661.31 | PPL: 14665.30 | true PPL: 14665.52
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  1.19s | valid ELBO 14665.32 | valid NLL 146657.30 | PPL: 14665.32 | true PPL: 14665.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  1.21s | valid ELBO 14664.02 | valid NLL 146655.58 | PPL: 14664.02 | true PPL: 14665.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  1.20s | valid ELBO 14666.15 | valid NLL 146659.45 | PPL: 14666.15 | true PPL: 14665.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  1.20s | valid ELBO 14665.56 | valid NLL 146653.81 | PPL: 14665.56 | true PPL: 14664.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  1.20s | valid ELBO 14665.86 | valid NLL 146652.69 | PPL: 14665.86 | true PPL: 14664.62
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  1.20s | valid ELBO 14665.47 | valid NLL 146650.90 | PPL: 14665.47 | true PPL: 14664.60
--------------------------------------------------------------------------------
