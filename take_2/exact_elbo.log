running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method exact_elbo --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 10 --filter
sha: af5404ef6e6fbc428d48a9dc4c9a0ea91b813775
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=10, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='exact_elbo', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
(15854.4453125, 14670.08740234375, -14670.087829589844)
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  0.50s | valid ELBO 15587.10 | valid NLL 14667.38 | PPL: 15587.10 | true PPL: 14667.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  0.41s | valid ELBO 15423.75 | valid NLL 14670.27 | PPL: 15423.75 | true PPL: 14670.27
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  0.35s | valid ELBO 15285.73 | valid NLL 14666.99 | PPL: 15285.73 | true PPL: 14666.99
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  0.33s | valid ELBO 15184.41 | valid NLL 14665.83 | PPL: 15184.41 | true PPL: 14665.83
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  0.32s | valid ELBO 15102.63 | valid NLL 14664.58 | PPL: 15102.63 | true PPL: 14664.58
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  0.33s | valid ELBO 15039.65 | valid NLL 14667.92 | PPL: 15039.65 | true PPL: 14667.92
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  0.32s | valid ELBO 14980.99 | valid NLL 14664.16 | PPL: 14980.99 | true PPL: 14664.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  0.32s | valid ELBO 14934.23 | valid NLL 14663.17 | PPL: 14934.23 | true PPL: 14663.16
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  0.33s | valid ELBO 14898.05 | valid NLL 14665.34 | PPL: 14898.05 | true PPL: 14665.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  0.33s | valid ELBO 14866.72 | valid NLL 14666.48 | PPL: 14866.72 | true PPL: 14666.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  0.33s | valid ELBO 14841.08 | valid NLL 14663.19 | PPL: 14841.08 | true PPL: 14663.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  0.33s | valid ELBO 14821.32 | valid NLL 14663.09 | PPL: 14821.32 | true PPL: 14663.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  0.33s | valid ELBO 14805.82 | valid NLL 14665.02 | PPL: 14805.82 | true PPL: 14665.02
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  0.33s | valid ELBO 14788.83 | valid NLL 14663.52 | PPL: 14788.83 | true PPL: 14663.51
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  0.33s | valid ELBO 14776.35 | valid NLL 14664.80 | PPL: 14776.35 | true PPL: 14664.79
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  0.33s | valid ELBO 14768.44 | valid NLL 14669.02 | PPL: 14768.44 | true PPL: 14669.01
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  0.33s | valid ELBO 14752.50 | valid NLL 14664.00 | PPL: 14752.50 | true PPL: 14664.00
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  0.32s | valid ELBO 14743.13 | valid NLL 14664.34 | PPL: 14743.13 | true PPL: 14664.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  0.33s | valid ELBO 14736.39 | valid NLL 14666.19 | PPL: 14736.39 | true PPL: 14666.19
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  0.33s | valid ELBO 14727.07 | valid NLL 14664.50 | PPL: 14727.07 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  0.33s | valid ELBO 14721.50 | valid NLL 14664.39 | PPL: 14721.50 | true PPL: 14664.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  0.32s | valid ELBO 14716.82 | valid NLL 14664.68 | PPL: 14716.82 | true PPL: 14664.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  0.32s | valid ELBO 14714.47 | valid NLL 14666.85 | PPL: 14714.47 | true PPL: 14666.85
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  0.33s | valid ELBO 14710.90 | valid NLL 14667.41 | PPL: 14710.90 | true PPL: 14667.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  0.32s | valid ELBO 14705.19 | valid NLL 14665.46 | PPL: 14705.19 | true PPL: 14665.46
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  0.33s | valid ELBO 14701.72 | valid NLL 14665.41 | PPL: 14701.72 | true PPL: 14665.41
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  0.32s | valid ELBO 14696.91 | valid NLL 14663.71 | PPL: 14696.91 | true PPL: 14663.70
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  0.33s | valid ELBO 14694.04 | valid NLL 14663.68 | PPL: 14694.04 | true PPL: 14663.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  0.32s | valid ELBO 14692.82 | valid NLL 14665.02 | PPL: 14692.82 | true PPL: 14665.03
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  0.32s | valid ELBO 14688.98 | valid NLL 14663.56 | PPL: 14688.98 | true PPL: 14663.56
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  0.32s | valid ELBO 14687.15 | valid NLL 14663.46 | PPL: 14687.15 | true PPL: 14663.46
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  0.33s | valid ELBO 14686.87 | valid NLL 14664.79 | PPL: 14686.87 | true PPL: 14664.79
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  0.33s | valid ELBO 14686.80 | valid NLL 14666.20 | PPL: 14686.80 | true PPL: 14666.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  0.32s | valid ELBO 14683.82 | valid NLL 14664.60 | PPL: 14683.82 | true PPL: 14664.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  0.32s | valid ELBO 14682.57 | valid NLL 14664.63 | PPL: 14682.57 | true PPL: 14664.65
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  0.35s | valid ELBO 14681.70 | valid NLL 14664.94 | PPL: 14681.70 | true PPL: 14664.95
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  0.33s | valid ELBO 14680.61 | valid NLL 14664.97 | PPL: 14680.61 | true PPL: 14664.99
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  0.33s | valid ELBO 14679.01 | valid NLL 14664.40 | PPL: 14679.01 | true PPL: 14664.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  0.33s | valid ELBO 14678.30 | valid NLL 14664.64 | PPL: 14678.30 | true PPL: 14664.66
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  0.33s | valid ELBO 14676.84 | valid NLL 14664.06 | PPL: 14676.84 | true PPL: 14664.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  0.33s | valid ELBO 14677.34 | valid NLL 14665.22 | PPL: 14677.34 | true PPL: 14665.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  0.33s | valid ELBO 14677.96 | valid NLL 14666.45 | PPL: 14677.96 | true PPL: 14666.50
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  0.33s | valid ELBO 14676.25 | valid NLL 14665.31 | PPL: 14676.25 | true PPL: 14665.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  0.32s | valid ELBO 14675.35 | valid NLL 14664.94 | PPL: 14675.35 | true PPL: 14665.04
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  0.33s | valid ELBO 14673.90 | valid NLL 14663.99 | PPL: 14673.90 | true PPL: 14664.12
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  0.33s | valid ELBO 14674.44 | valid NLL 14665.01 | PPL: 14674.44 | true PPL: 14665.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  0.32s | valid ELBO 14674.68 | valid NLL 14665.66 | PPL: 14674.68 | true PPL: 14665.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  0.33s | valid ELBO 14672.50 | valid NLL 14663.84 | PPL: 14672.50 | true PPL: 14664.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  0.33s | valid ELBO 14672.29 | valid NLL 14663.97 | PPL: 14672.29 | true PPL: 14664.37
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  0.33s | valid ELBO 14671.65 | valid NLL 14663.60 | PPL: 14671.65 | true PPL: 14664.14
--------------------------------------------------------------------------------
