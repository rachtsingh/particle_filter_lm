running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_filter --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 5 --filter
(Variable containing:
 0.3000
[torch.FloatTensor of size (1,)]
, Variable containing:
 0.3500
[torch.FloatTensor of size (1,)]
)
sha: ff47e02ed94e7f68d912a7669267a11601025e95
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=5, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_filter', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  2.92s | valid ELBO 15660.18 | valid NLL 14665.72 | PPL: 15660.18 | true PPL: 14665.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  2.54s | valid ELBO 15507.72 | valid NLL 14664.31 | PPL: 15507.72 | true PPL: 14664.29
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  2.42s | valid ELBO 15386.35 | valid NLL 14664.24 | PPL: 15386.35 | true PPL: 14664.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  2.43s | valid ELBO 15282.71 | valid NLL 14663.88 | PPL: 15282.71 | true PPL: 14663.69
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  2.40s | valid ELBO 15202.72 | valid NLL 14665.94 | PPL: 15202.72 | true PPL: 14665.56
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  2.25s | valid ELBO 15129.02 | valid NLL 14665.44 | PPL: 15129.02 | true PPL: 14664.95
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  2.26s | valid ELBO 15070.28 | valid NLL 14664.28 | PPL: 15070.28 | true PPL: 14663.74
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  2.28s | valid ELBO 15022.08 | valid NLL 14666.03 | PPL: 15022.08 | true PPL: 14665.43
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  2.26s | valid ELBO 14979.20 | valid NLL 14665.52 | PPL: 14979.20 | true PPL: 14664.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  2.25s | valid ELBO 14944.46 | valid NLL 14664.52 | PPL: 14944.46 | true PPL: 14663.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  2.25s | valid ELBO 14920.89 | valid NLL 14664.64 | PPL: 14920.89 | true PPL: 14664.04
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  2.25s | valid ELBO 14899.26 | valid NLL 14665.84 | PPL: 14899.26 | true PPL: 14665.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  2.21s | valid ELBO 14879.17 | valid NLL 14665.21 | PPL: 14879.17 | true PPL: 14664.51
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  2.18s | valid ELBO 14862.15 | valid NLL 14664.96 | PPL: 14862.15 | true PPL: 14664.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  2.22s | valid ELBO 14849.43 | valid NLL 14665.19 | PPL: 14849.43 | true PPL: 14664.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  2.22s | valid ELBO 14835.93 | valid NLL 14665.55 | PPL: 14835.93 | true PPL: 14664.80
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  2.22s | valid ELBO 14824.22 | valid NLL 14664.58 | PPL: 14824.22 | true PPL: 14663.86
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  2.18s | valid ELBO 14818.41 | valid NLL 14667.36 | PPL: 14818.41 | true PPL: 14666.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  2.20s | valid ELBO 14805.23 | valid NLL 14664.68 | PPL: 14805.23 | true PPL: 14663.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  2.19s | valid ELBO 14802.51 | valid NLL 14664.62 | PPL: 14802.51 | true PPL: 14663.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  2.18s | valid ELBO 14796.95 | valid NLL 14666.89 | PPL: 14796.95 | true PPL: 14666.17
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  2.19s | valid ELBO 14791.96 | valid NLL 14664.35 | PPL: 14791.96 | true PPL: 14663.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  2.19s | valid ELBO 14786.36 | valid NLL 14665.55 | PPL: 14786.36 | true PPL: 14664.84
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  2.19s | valid ELBO 14783.97 | valid NLL 14664.75 | PPL: 14783.97 | true PPL: 14664.06
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  2.18s | valid ELBO 14777.82 | valid NLL 14665.15 | PPL: 14777.82 | true PPL: 14664.45
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  2.19s | valid ELBO 14776.14 | valid NLL 14664.36 | PPL: 14776.14 | true PPL: 14663.74
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  2.20s | valid ELBO 14773.89 | valid NLL 14665.42 | PPL: 14773.89 | true PPL: 14664.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  2.20s | valid ELBO 14770.52 | valid NLL 14664.51 | PPL: 14770.52 | true PPL: 14663.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  2.22s | valid ELBO 14769.54 | valid NLL 14665.93 | PPL: 14769.54 | true PPL: 14665.32
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  2.20s | valid ELBO 14770.17 | valid NLL 14666.31 | PPL: 14770.17 | true PPL: 14665.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  2.19s | valid ELBO 14766.16 | valid NLL 14665.04 | PPL: 14766.16 | true PPL: 14664.46
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  2.23s | valid ELBO 14765.53 | valid NLL 14665.34 | PPL: 14765.53 | true PPL: 14664.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  2.21s | valid ELBO 14763.04 | valid NLL 14665.52 | PPL: 14763.04 | true PPL: 14664.92
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  2.20s | valid ELBO 14763.84 | valid NLL 14665.63 | PPL: 14763.84 | true PPL: 14665.06
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  2.21s | valid ELBO 14761.90 | valid NLL 14664.89 | PPL: 14761.90 | true PPL: 14664.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  2.22s | valid ELBO 14761.92 | valid NLL 14664.97 | PPL: 14761.92 | true PPL: 14664.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  2.23s | valid ELBO 14760.23 | valid NLL 14665.05 | PPL: 14760.23 | true PPL: 14664.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  2.20s | valid ELBO 14760.31 | valid NLL 14666.56 | PPL: 14760.31 | true PPL: 14665.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  2.21s | valid ELBO 14758.87 | valid NLL 14665.05 | PPL: 14758.87 | true PPL: 14664.53
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  2.17s | valid ELBO 14758.68 | valid NLL 14665.38 | PPL: 14758.68 | true PPL: 14664.81
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  2.20s | valid ELBO 14757.87 | valid NLL 14665.70 | PPL: 14757.87 | true PPL: 14665.14
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  2.19s | valid ELBO 14758.50 | valid NLL 14665.78 | PPL: 14758.50 | true PPL: 14665.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  2.18s | valid ELBO 14755.36 | valid NLL 14664.92 | PPL: 14755.36 | true PPL: 14664.38
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  2.18s | valid ELBO 14754.77 | valid NLL 14665.80 | PPL: 14754.77 | true PPL: 14665.25
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  2.19s | valid ELBO 14756.66 | valid NLL 14665.44 | PPL: 14756.66 | true PPL: 14664.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  2.20s | valid ELBO 14758.11 | valid NLL 14665.79 | PPL: 14758.11 | true PPL: 14665.24
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  2.23s | valid ELBO 14754.67 | valid NLL 14665.16 | PPL: 14754.67 | true PPL: 14664.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  2.20s | valid ELBO 14754.53 | valid NLL 14665.28 | PPL: 14754.53 | true PPL: 14664.74
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  2.20s | valid ELBO 14755.29 | valid NLL 14665.88 | PPL: 14755.29 | true PPL: 14665.32
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  2.22s | valid ELBO 14754.31 | valid NLL 14665.29 | PPL: 14754.31 | true PPL: 14664.75
--------------------------------------------------------------------------------
