running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_filter --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 10 --filter
(Variable containing:
 0.3000
[torch.FloatTensor of size (1,)]
, Variable containing:
 0.3500
[torch.FloatTensor of size (1,)]
)
sha: ff47e02ed94e7f68d912a7669267a11601025e95
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=True, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=10, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_filter', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  2.94s | valid ELBO 15681.32 | valid NLL 14665.73 | PPL: 15681.32 | true PPL: 14665.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  2.73s | valid ELBO 15550.49 | valid NLL 14664.16 | PPL: 15550.49 | true PPL: 14664.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  2.76s | valid ELBO 15443.38 | valid NLL 14664.30 | PPL: 15443.38 | true PPL: 14664.23
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  2.76s | valid ELBO 15348.28 | valid NLL 14663.77 | PPL: 15348.28 | true PPL: 14663.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  2.76s | valid ELBO 15271.60 | valid NLL 14665.67 | PPL: 15271.60 | true PPL: 14665.29
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  2.77s | valid ELBO 15199.67 | valid NLL 14666.10 | PPL: 15199.67 | true PPL: 14665.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  2.75s | valid ELBO 15141.78 | valid NLL 14665.31 | PPL: 15141.78 | true PPL: 14663.54
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  2.75s | valid ELBO 15090.98 | valid NLL 14668.58 | PPL: 15090.98 | true PPL: 14665.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  2.76s | valid ELBO 15047.91 | valid NLL 14669.78 | PPL: 15047.91 | true PPL: 14665.27
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  2.75s | valid ELBO 15010.36 | valid NLL 14669.81 | PPL: 15010.36 | true PPL: 14663.97
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  2.77s | valid ELBO 14981.41 | valid NLL 14672.35 | PPL: 14981.41 | true PPL: 14663.96
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  2.75s | valid ELBO 14962.41 | valid NLL 14677.11 | PPL: 14962.41 | true PPL: 14665.38
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  2.75s | valid ELBO 14944.72 | valid NLL 14680.50 | PPL: 14944.72 | true PPL: 14664.60
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  2.75s | valid ELBO 14933.91 | valid NLL 14690.21 | PPL: 14933.91 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  2.76s | valid ELBO 14927.56 | valid NLL 14698.93 | PPL: 14927.56 | true PPL: 14664.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  2.77s | valid ELBO 14937.62 | valid NLL 14727.85 | PPL: 14937.62 | true PPL: 14664.93
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  2.76s | valid ELBO 14950.34 | valid NLL 14751.31 | PPL: 14950.34 | true PPL: 14664.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  2.75s | valid ELBO 15053.32 | valid NLL 14869.09 | PPL: 15053.32 | true PPL: 14665.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  2.74s | valid ELBO 15349.16 | valid NLL 15173.83 | PPL: 15349.16 | true PPL: 14663.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  2.75s | valid ELBO 15948.82 | valid NLL 15787.11 | PPL: 15948.82 | true PPL: 14667.11
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  2.75s | valid ELBO 16634.95 | valid NLL 16478.92 | PPL: 16634.95 | true PPL: 14666.94
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  2.78s | valid ELBO 17286.86 | valid NLL 17132.37 | PPL: 17286.86 | true PPL: 14670.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  2.75s | valid ELBO 17902.15 | valid NLL 17750.86 | PPL: 17902.15 | true PPL: 14673.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  2.75s | valid ELBO 18395.12 | valid NLL 18250.44 | PPL: 18395.12 | true PPL: 14679.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  2.73s | valid ELBO 18737.80 | valid NLL 18599.36 | PPL: 18737.80 | true PPL: 14674.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  2.75s | valid ELBO 19016.21 | valid NLL 18880.54 | PPL: 19016.21 | true PPL: 14666.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  2.73s | valid ELBO 19153.43 | valid NLL 19024.42 | PPL: 19153.43 | true PPL: 14668.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  2.73s | valid ELBO 19285.05 | valid NLL 19161.46 | PPL: 19285.05 | true PPL: 14672.65
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  2.75s | valid ELBO 19367.11 | valid NLL 19243.82 | PPL: 19367.11 | true PPL: 14667.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  2.74s | valid ELBO 19527.97 | valid NLL 19408.27 | PPL: 19527.97 | true PPL: 14669.37
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  2.70s | valid ELBO 19653.65 | valid NLL 19536.95 | PPL: 19653.65 | true PPL: 14663.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  2.72s | valid ELBO 19769.03 | valid NLL 19654.97 | PPL: 19769.03 | true PPL: 14668.46
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  2.73s | valid ELBO 19946.13 | valid NLL 19833.43 | PPL: 19946.13 | true PPL: 14667.55
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  2.73s | valid ELBO 20046.75 | valid NLL 19936.47 | PPL: 20046.75 | true PPL: 14668.37
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  2.73s | valid ELBO 20125.14 | valid NLL 20013.77 | PPL: 20125.14 | true PPL: 14663.61
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  2.73s | valid ELBO 20233.52 | valid NLL 20127.55 | PPL: 20233.52 | true PPL: 14664.97
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  2.76s | valid ELBO 20334.44 | valid NLL 20227.38 | PPL: 20334.44 | true PPL: 14670.92
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  2.77s | valid ELBO 20345.83 | valid NLL 20238.67 | PPL: 20345.83 | true PPL: 14666.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  2.77s | valid ELBO 20472.43 | valid NLL 20369.42 | PPL: 20472.43 | true PPL: 14665.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  2.77s | valid ELBO 20535.09 | valid NLL 20431.33 | PPL: 20535.09 | true PPL: 14664.60
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  2.76s | valid ELBO 20599.91 | valid NLL 20499.10 | PPL: 20599.91 | true PPL: 14666.52
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  2.74s | valid ELBO 20655.76 | valid NLL 20553.24 | PPL: 20655.76 | true PPL: 14668.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  2.76s | valid ELBO 20714.07 | valid NLL 20614.02 | PPL: 20714.07 | true PPL: 14666.78
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  2.78s | valid ELBO 20716.07 | valid NLL 20615.81 | PPL: 20716.07 | true PPL: 14665.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  2.78s | valid ELBO 20766.81 | valid NLL 20666.02 | PPL: 20766.81 | true PPL: 14664.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  2.76s | valid ELBO 20840.51 | valid NLL 20742.94 | PPL: 20840.51 | true PPL: 14667.92
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  2.76s | valid ELBO 20870.21 | valid NLL 20773.76 | PPL: 20870.21 | true PPL: 14662.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  2.76s | valid ELBO 20941.38 | valid NLL 20843.40 | PPL: 20941.38 | true PPL: 14668.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  2.78s | valid ELBO 20957.62 | valid NLL 20861.21 | PPL: 20957.62 | true PPL: 14665.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  2.76s | valid ELBO 21032.87 | valid NLL 20939.88 | PPL: 21032.87 | true PPL: 14664.89
--------------------------------------------------------------------------------
