running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_elbo --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50
(Variable containing:
 0.3000
[torch.FloatTensor of size (1,)]
, Variable containing:
 0.3500
[torch.FloatTensor of size (1,)]
)
sha: ff47e02ed94e7f68d912a7669267a11601025e95
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=False, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=5, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_elbo', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  2.45s | valid ELBO 15424.72 | valid NLL 14665.43 | PPL: 15424.72 | true PPL: 14665.42
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  2.18s | valid ELBO 15175.79 | valid NLL 14664.37 | PPL: 15175.79 | true PPL: 14664.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  2.16s | valid ELBO 15027.51 | valid NLL 14664.13 | PPL: 15027.51 | true PPL: 14664.11
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  1.96s | valid ELBO 14926.31 | valid NLL 14663.63 | PPL: 14926.31 | true PPL: 14663.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  1.89s | valid ELBO 14857.54 | valid NLL 14665.78 | PPL: 14857.54 | true PPL: 14665.72
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  1.91s | valid ELBO 14805.14 | valid NLL 14664.93 | PPL: 14805.14 | true PPL: 14664.89
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  1.86s | valid ELBO 14767.51 | valid NLL 14663.91 | PPL: 14767.51 | true PPL: 14663.85
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  1.88s | valid ELBO 14740.69 | valid NLL 14665.86 | PPL: 14740.69 | true PPL: 14665.80
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  1.87s | valid ELBO 14719.25 | valid NLL 14664.66 | PPL: 14719.25 | true PPL: 14664.58
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  1.86s | valid ELBO 14704.59 | valid NLL 14663.96 | PPL: 14704.59 | true PPL: 14663.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  1.85s | valid ELBO 14694.67 | valid NLL 14664.35 | PPL: 14694.67 | true PPL: 14664.24
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  1.83s | valid ELBO 14689.45 | valid NLL 14665.16 | PPL: 14689.45 | true PPL: 14665.07
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  1.83s | valid ELBO 14684.53 | valid NLL 14664.49 | PPL: 14684.53 | true PPL: 14664.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  1.84s | valid ELBO 14678.90 | valid NLL 14664.32 | PPL: 14678.90 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  1.83s | valid ELBO 14677.67 | valid NLL 14664.88 | PPL: 14677.67 | true PPL: 14664.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  1.83s | valid ELBO 14675.79 | valid NLL 14665.03 | PPL: 14675.79 | true PPL: 14664.69
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  1.87s | valid ELBO 14672.46 | valid NLL 14664.30 | PPL: 14672.46 | true PPL: 14663.81
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  1.86s | valid ELBO 14674.02 | valid NLL 14667.12 | PPL: 14674.02 | true PPL: 14666.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  1.84s | valid ELBO 14671.65 | valid NLL 14664.82 | PPL: 14671.65 | true PPL: 14663.80
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  1.85s | valid ELBO 14670.92 | valid NLL 14665.74 | PPL: 14670.92 | true PPL: 14664.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  1.84s | valid ELBO 14673.47 | valid NLL 14667.96 | PPL: 14673.47 | true PPL: 14665.72
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  1.83s | valid ELBO 14671.94 | valid NLL 14667.04 | PPL: 14671.94 | true PPL: 14663.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  1.83s | valid ELBO 14673.78 | valid NLL 14669.79 | PPL: 14673.78 | true PPL: 14664.82
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  1.84s | valid ELBO 14674.69 | valid NLL 14670.78 | PPL: 14674.69 | true PPL: 14664.01
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  1.87s | valid ELBO 14677.46 | valid NLL 14674.00 | PPL: 14677.46 | true PPL: 14664.44
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  1.88s | valid ELBO 14682.86 | valid NLL 14678.26 | PPL: 14682.86 | true PPL: 14664.02
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  1.87s | valid ELBO 14685.21 | valid NLL 14681.37 | PPL: 14685.21 | true PPL: 14664.44
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  1.86s | valid ELBO 14689.14 | valid NLL 14686.55 | PPL: 14689.14 | true PPL: 14664.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  1.87s | valid ELBO 14695.20 | valid NLL 14692.37 | PPL: 14695.20 | true PPL: 14665.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  1.86s | valid ELBO 14699.03 | valid NLL 14696.06 | PPL: 14699.03 | true PPL: 14665.99
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  1.88s | valid ELBO 14699.84 | valid NLL 14697.11 | PPL: 14699.84 | true PPL: 14664.55
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  1.84s | valid ELBO 14705.33 | valid NLL 14702.82 | PPL: 14705.33 | true PPL: 14664.86
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  1.85s | valid ELBO 14712.15 | valid NLL 14709.35 | PPL: 14712.15 | true PPL: 14665.14
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  1.86s | valid ELBO 14716.53 | valid NLL 14713.73 | PPL: 14716.53 | true PPL: 14665.22
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  1.85s | valid ELBO 14718.06 | valid NLL 14715.35 | PPL: 14718.06 | true PPL: 14664.74
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  1.84s | valid ELBO 14727.46 | valid NLL 14724.73 | PPL: 14727.46 | true PPL: 14664.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  1.85s | valid ELBO 14732.60 | valid NLL 14730.14 | PPL: 14732.60 | true PPL: 14664.60
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  1.84s | valid ELBO 14740.42 | valid NLL 14737.60 | PPL: 14740.42 | true PPL: 14665.94
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  1.86s | valid ELBO 14745.07 | valid NLL 14742.41 | PPL: 14745.07 | true PPL: 14664.64
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  1.85s | valid ELBO 14759.77 | valid NLL 14756.41 | PPL: 14759.77 | true PPL: 14665.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  1.85s | valid ELBO 14765.62 | valid NLL 14763.29 | PPL: 14765.62 | true PPL: 14665.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  1.86s | valid ELBO 14769.53 | valid NLL 14766.89 | PPL: 14769.53 | true PPL: 14665.51
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  1.86s | valid ELBO 14779.33 | valid NLL 14776.65 | PPL: 14779.33 | true PPL: 14664.64
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  1.85s | valid ELBO 14793.57 | valid NLL 14791.00 | PPL: 14793.57 | true PPL: 14666.23
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  1.87s | valid ELBO 14805.23 | valid NLL 14802.68 | PPL: 14805.23 | true PPL: 14665.30
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  1.86s | valid ELBO 14816.26 | valid NLL 14813.67 | PPL: 14816.26 | true PPL: 14666.00
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  1.86s | valid ELBO 14830.20 | valid NLL 14827.33 | PPL: 14830.20 | true PPL: 14664.74
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  1.85s | valid ELBO 14840.08 | valid NLL 14837.46 | PPL: 14840.08 | true PPL: 14665.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  1.85s | valid ELBO 14854.75 | valid NLL 14852.21 | PPL: 14854.75 | true PPL: 14665.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  1.85s | valid ELBO 14881.67 | valid NLL 14878.75 | PPL: 14881.67 | true PPL: 14665.21
--------------------------------------------------------------------------------
