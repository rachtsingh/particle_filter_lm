running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method exact_elbo --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50
(Variable containing:
 0.3000
[torch.FloatTensor of size (1,)]
, Variable containing:
 0.3500
[torch.FloatTensor of size (1,)]
)
sha: ff47e02ed94e7f68d912a7669267a11601025e95
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=False, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=5, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='exact_elbo', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  0.98s | valid ELBO 15378.35 | valid NLL 14665.42 | PPL: 15378.35 | true PPL: 14665.42
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  0.74s | valid ELBO 15137.03 | valid NLL 14664.35 | PPL: 15137.03 | true PPL: 14664.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  0.67s | valid ELBO 14990.14 | valid NLL 14664.11 | PPL: 14990.14 | true PPL: 14664.10
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  0.67s | valid ELBO 14893.06 | valid NLL 14663.59 | PPL: 14893.06 | true PPL: 14663.59
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  0.67s | valid ELBO 14829.35 | valid NLL 14665.71 | PPL: 14829.35 | true PPL: 14665.71
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  0.67s | valid ELBO 14782.41 | valid NLL 14664.88 | PPL: 14782.41 | true PPL: 14664.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  0.66s | valid ELBO 14748.64 | valid NLL 14663.86 | PPL: 14748.64 | true PPL: 14663.85
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  0.67s | valid ELBO 14727.13 | valid NLL 14665.77 | PPL: 14727.13 | true PPL: 14665.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  0.70s | valid ELBO 14709.40 | valid NLL 14664.58 | PPL: 14709.40 | true PPL: 14664.58
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  0.67s | valid ELBO 14696.58 | valid NLL 14663.87 | PPL: 14696.58 | true PPL: 14663.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  0.67s | valid ELBO 14689.94 | valid NLL 14664.27 | PPL: 14689.94 | true PPL: 14664.28
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  0.67s | valid ELBO 14685.26 | valid NLL 14665.02 | PPL: 14685.26 | true PPL: 14665.03
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  0.67s | valid ELBO 14680.36 | valid NLL 14664.28 | PPL: 14680.36 | true PPL: 14664.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  0.67s | valid ELBO 14676.89 | valid NLL 14663.96 | PPL: 14676.89 | true PPL: 14664.14
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  0.67s | valid ELBO 14674.71 | valid NLL 14664.04 | PPL: 14674.71 | true PPL: 14664.51
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  0.67s | valid ELBO 14672.70 | valid NLL 14663.16 | PPL: 14672.70 | true PPL: 14664.49
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  0.67s | valid ELBO 14670.69 | valid NLL 14660.03 | PPL: 14670.69 | true PPL: 14663.99
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  0.66s | valid ELBO 14671.42 | valid NLL 14658.74 | PPL: 14671.42 | true PPL: 14665.96
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  0.67s | valid ELBO 14668.94 | valid NLL 14652.83 | PPL: 14668.94 | true PPL: 14664.37
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  0.67s | valid ELBO 14668.73 | valid NLL 14650.89 | PPL: 14668.73 | true PPL: 14664.83
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  0.68s | valid ELBO 14669.66 | valid NLL 14651.40 | PPL: 14669.66 | true PPL: 14666.41
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  0.67s | valid ELBO 14667.70 | valid NLL 14649.12 | PPL: 14667.70 | true PPL: 14664.85
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  0.67s | valid ELBO 14668.16 | valid NLL 14649.54 | PPL: 14668.16 | true PPL: 14665.66
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  0.67s | valid ELBO 14666.90 | valid NLL 14649.69 | PPL: 14666.90 | true PPL: 14664.73
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  0.67s | valid ELBO 14667.27 | valid NLL 14649.99 | PPL: 14667.27 | true PPL: 14665.34
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  0.67s | valid ELBO 14667.16 | valid NLL 14649.21 | PPL: 14667.16 | true PPL: 14665.39
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  0.68s | valid ELBO 14666.86 | valid NLL 14650.91 | PPL: 14666.86 | true PPL: 14665.33
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  0.68s | valid ELBO 14666.67 | valid NLL 14650.47 | PPL: 14666.67 | true PPL: 14665.28
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  0.67s | valid ELBO 14667.60 | valid NLL 14651.20 | PPL: 14667.60 | true PPL: 14666.38
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  0.68s | valid ELBO 14667.92 | valid NLL 14651.16 | PPL: 14667.92 | true PPL: 14666.79
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  0.68s | valid ELBO 14666.39 | valid NLL 14651.11 | PPL: 14666.39 | true PPL: 14665.37
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  0.67s | valid ELBO 14666.84 | valid NLL 14650.54 | PPL: 14666.84 | true PPL: 14665.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  0.67s | valid ELBO 14667.00 | valid NLL 14650.26 | PPL: 14667.00 | true PPL: 14666.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  0.67s | valid ELBO 14666.71 | valid NLL 14651.09 | PPL: 14666.71 | true PPL: 14665.89
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  0.67s | valid ELBO 14666.45 | valid NLL 14650.24 | PPL: 14666.45 | true PPL: 14665.68
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  0.67s | valid ELBO 14666.12 | valid NLL 14649.49 | PPL: 14666.12 | true PPL: 14665.40
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  0.67s | valid ELBO 14666.37 | valid NLL 14650.95 | PPL: 14666.37 | true PPL: 14665.70
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  0.67s | valid ELBO 14667.30 | valid NLL 14651.07 | PPL: 14667.30 | true PPL: 14666.67
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  0.68s | valid ELBO 14666.40 | valid NLL 14650.00 | PPL: 14666.40 | true PPL: 14665.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  0.67s | valid ELBO 14666.50 | valid NLL 14650.45 | PPL: 14666.50 | true PPL: 14665.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  0.66s | valid ELBO 14666.62 | valid NLL 14649.79 | PPL: 14666.62 | true PPL: 14666.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  0.67s | valid ELBO 14666.81 | valid NLL 14650.84 | PPL: 14666.81 | true PPL: 14666.30
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  0.70s | valid ELBO 14666.05 | valid NLL 14650.04 | PPL: 14666.05 | true PPL: 14665.57
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  0.67s | valid ELBO 14666.99 | valid NLL 14650.89 | PPL: 14666.99 | true PPL: 14666.53
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  0.67s | valid ELBO 14666.35 | valid NLL 14650.62 | PPL: 14666.35 | true PPL: 14665.92
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  0.67s | valid ELBO 14666.96 | valid NLL 14652.04 | PPL: 14666.96 | true PPL: 14666.54
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  0.67s | valid ELBO 14666.09 | valid NLL 14650.26 | PPL: 14666.09 | true PPL: 14665.69
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  0.67s | valid ELBO 14666.47 | valid NLL 14650.37 | PPL: 14666.47 | true PPL: 14666.10
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  0.66s | valid ELBO 14666.64 | valid NLL 14650.95 | PPL: 14666.64 | true PPL: 14666.29
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  0.67s | valid ELBO 14666.38 | valid NLL 14650.30 | PPL: 14666.38 | true PPL: 14666.05
--------------------------------------------------------------------------------
