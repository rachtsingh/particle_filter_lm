running run_vi_exp.py --dataset data/misspecified/larger_hmm_data.pt --model ablation --train-method sampled_iwae --x-dim 50 --z-dim 50 --word-dim 50 --no-scheduler --epochs 50 --num-importance-samples 10
(Variable containing:
 0.3000
[torch.FloatTensor of size (1,)]
, Variable containing:
 0.3500
[torch.FloatTensor of size (1,)]
)
sha: ff47e02ed94e7f68d912a7669267a11601025e95
('args:', Namespace(base_filename=None, batch_size=80, clip=3.0, cuda=True, dataset='data/misspecified/larger_hmm_data.pt', embedding=None, epochs=50, filter=False, finetune_inference=False, hidden=10, kl_anneal_delay=4, kl_anneal_rate=0.0001, kl_anneal_start=0.0001, load_hmm=None, load_inference=None, load_model=None, load_z_gru=None, log_interval=500, lr=0.01, lstm_sz=200, model='ablation', nhid=32, no_cuda=False, no_scheduler=True, num_importance_samples=10, print_best=False, prof=None, quiet=False, save=None, save_params=None, seed=1111, slurm_id=None, temp=0.3, temp_prior=0.35, train_method='sampled_iwae', word_dim=50, x_dim=50, z_dim=50))
('model total parameters:', 31284)
model architecture:
HMM_Gradients(
  (inp_embedding): Embedding(50, 50)
  (encoder): LSTM(50, 32, bidirectional=True)
  (enc): ModuleList(
    (0): Embedding(50, 50)
    (1): LSTM(50, 32, bidirectional=True)
  )
  (z_decoder): None
  (logits): Sequential(
    (0): Linear(in_features=64, out_features=32, bias=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=50, bias=True)
  )
)
ignoring scheduler, lr is fixed
-----------------------------------------------------------------------------------------
ELBO: 15854.45, val_nll: 14670.09, ELBO ppl:   inf, true ppl:   inf
-----------------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   1 | time:  4.28s | valid ELBO 15458.51 | valid NLL 14665.43 | PPL: 15458.51 | true PPL: 14665.43
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   2 | time:  3.88s | valid ELBO 15221.52 | valid NLL 14664.39 | PPL: 15221.52 | true PPL: 14664.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   3 | time:  3.88s | valid ELBO 15071.79 | valid NLL 14664.29 | PPL: 15071.79 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   4 | time:  3.91s | valid ELBO 14966.04 | valid NLL 14663.89 | PPL: 14966.04 | true PPL: 14663.60
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   5 | time:  3.85s | valid ELBO 14894.66 | valid NLL 14666.14 | PPL: 14894.66 | true PPL: 14665.72
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   6 | time:  3.87s | valid ELBO 14839.15 | valid NLL 14665.47 | PPL: 14839.15 | true PPL: 14664.90
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   7 | time:  3.89s | valid ELBO 14796.91 | valid NLL 14664.54 | PPL: 14796.91 | true PPL: 14663.86
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   8 | time:  3.87s | valid ELBO 14766.02 | valid NLL 14666.55 | PPL: 14766.02 | true PPL: 14665.81
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch   9 | time:  3.88s | valid ELBO 14739.86 | valid NLL 14665.53 | PPL: 14739.86 | true PPL: 14664.62
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  10 | time:  3.89s | valid ELBO 14720.73 | valid NLL 14664.92 | PPL: 14720.73 | true PPL: 14663.88
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  11 | time:  3.90s | valid ELBO 14709.10 | valid NLL 14665.30 | PPL: 14709.10 | true PPL: 14664.20
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  12 | time:  3.85s | valid ELBO 14701.15 | valid NLL 14666.29 | PPL: 14701.15 | true PPL: 14665.15
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  13 | time:  3.89s | valid ELBO 14693.45 | valid NLL 14665.62 | PPL: 14693.45 | true PPL: 14664.36
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  14 | time:  3.84s | valid ELBO 14688.42 | valid NLL 14665.40 | PPL: 14688.42 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  15 | time:  3.87s | valid ELBO 14683.29 | valid NLL 14665.77 | PPL: 14683.29 | true PPL: 14664.64
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  16 | time:  3.86s | valid ELBO 14680.79 | valid NLL 14665.96 | PPL: 14680.79 | true PPL: 14664.77
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  17 | time:  3.86s | valid ELBO 14677.54 | valid NLL 14665.04 | PPL: 14677.54 | true PPL: 14663.82
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  18 | time:  3.86s | valid ELBO 14678.70 | valid NLL 14667.86 | PPL: 14678.70 | true PPL: 14666.70
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  19 | time:  3.88s | valid ELBO 14674.44 | valid NLL 14665.09 | PPL: 14674.44 | true PPL: 14663.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  20 | time:  3.85s | valid ELBO 14673.78 | valid NLL 14665.49 | PPL: 14673.78 | true PPL: 14664.18
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  21 | time:  3.86s | valid ELBO 14674.28 | valid NLL 14667.39 | PPL: 14674.28 | true PPL: 14665.98
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  22 | time:  3.87s | valid ELBO 14671.06 | valid NLL 14665.15 | PPL: 14671.06 | true PPL: 14663.69
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  23 | time:  3.91s | valid ELBO 14671.74 | valid NLL 14666.63 | PPL: 14671.74 | true PPL: 14664.96
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  24 | time:  3.90s | valid ELBO 14670.96 | valid NLL 14665.92 | PPL: 14670.96 | true PPL: 14664.13
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  25 | time:  3.88s | valid ELBO 14671.18 | valid NLL 14666.57 | PPL: 14671.18 | true PPL: 14664.54
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  26 | time:  3.88s | valid ELBO 14671.28 | valid NLL 14666.34 | PPL: 14671.28 | true PPL: 14663.91
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  27 | time:  3.87s | valid ELBO 14671.23 | valid NLL 14667.46 | PPL: 14671.23 | true PPL: 14664.58
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  28 | time:  3.87s | valid ELBO 14671.01 | valid NLL 14667.60 | PPL: 14671.01 | true PPL: 14664.10
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  29 | time:  3.88s | valid ELBO 14673.36 | valid NLL 14669.81 | PPL: 14673.36 | true PPL: 14665.43
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  30 | time:  3.90s | valid ELBO 14674.06 | valid NLL 14670.98 | PPL: 14674.06 | true PPL: 14665.48
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  31 | time:  3.89s | valid ELBO 14673.89 | valid NLL 14670.81 | PPL: 14673.89 | true PPL: 14664.47
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  32 | time:  3.86s | valid ELBO 14675.56 | valid NLL 14672.66 | PPL: 14675.56 | true PPL: 14664.78
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  33 | time:  3.88s | valid ELBO 14677.79 | valid NLL 14674.81 | PPL: 14677.79 | true PPL: 14664.83
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  34 | time:  3.87s | valid ELBO 14680.06 | valid NLL 14676.71 | PPL: 14680.06 | true PPL: 14664.94
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  35 | time:  3.91s | valid ELBO 14680.53 | valid NLL 14677.66 | PPL: 14680.53 | true PPL: 14664.55
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  36 | time:  3.87s | valid ELBO 14682.94 | valid NLL 14680.35 | PPL: 14682.94 | true PPL: 14664.26
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  37 | time:  3.88s | valid ELBO 14686.63 | valid NLL 14683.64 | PPL: 14686.63 | true PPL: 14664.63
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  38 | time:  3.88s | valid ELBO 14690.78 | valid NLL 14687.68 | PPL: 14690.78 | true PPL: 14665.75
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  39 | time:  3.88s | valid ELBO 14691.90 | valid NLL 14688.84 | PPL: 14691.90 | true PPL: 14664.60
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  40 | time:  3.89s | valid ELBO 14696.32 | valid NLL 14693.80 | PPL: 14696.32 | true PPL: 14664.83
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  41 | time:  3.89s | valid ELBO 14699.67 | valid NLL 14697.64 | PPL: 14699.67 | true PPL: 14664.87
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  42 | time:  3.87s | valid ELBO 14701.97 | valid NLL 14699.88 | PPL: 14701.97 | true PPL: 14665.08
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  43 | time:  3.86s | valid ELBO 14703.90 | valid NLL 14701.38 | PPL: 14703.90 | true PPL: 14664.35
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  44 | time:  3.89s | valid ELBO 14707.67 | valid NLL 14705.07 | PPL: 14707.67 | true PPL: 14665.21
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  45 | time:  3.89s | valid ELBO 14708.41 | valid NLL 14706.15 | PPL: 14708.41 | true PPL: 14664.80
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  46 | time:  3.93s | valid ELBO 14710.85 | valid NLL 14708.54 | PPL: 14710.85 | true PPL: 14665.27
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  47 | time:  3.86s | valid ELBO 14713.89 | valid NLL 14711.65 | PPL: 14713.89 | true PPL: 14664.43
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  48 | time:  3.89s | valid ELBO 14716.99 | valid NLL 14714.68 | PPL: 14716.99 | true PPL: 14664.64
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  49 | time:  3.84s | valid ELBO 14718.72 | valid NLL 14716.29 | PPL: 14718.72 | true PPL: 14665.09
--------------------------------------------------------------------------------
anneal: 0.000
--------------------------------------------------------------------------------
| end of epoch  50 | time:  3.82s | valid ELBO 14722.67 | valid NLL 14720.07 | PPL: 14722.67 | true PPL: 14664.70
--------------------------------------------------------------------------------
